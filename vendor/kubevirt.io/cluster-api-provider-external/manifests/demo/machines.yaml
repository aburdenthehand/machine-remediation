---
apiVersion: "cluster.k8s.io/v1alpha1"
kind: Machine
metadata:
  generateName: demo-echo-
  labels:
    set: master
spec:
  providerConfig:
    value:
      apiVersion: "extproviderconfig/v1alpha1"
      kind: "ExternalMachineProviderConfig"
      fencingConfig:
        container:
          name: baremetal-fencing
          image: quay.io/beekhof/fence-agents:latest
        createArgs: [ "/bin/echo", "/sbin/fence_ipmilan", "--user", "admin", "-o", "on", "--ip", "1.2.3.4" ]
        deleteArgs: [ "/bin/echo", "/sbin/fence_ipmilan", "--user", "admin", "-o", "off", "--ip", "1.2.3.4" ]
        argumentFormat: cli
        passTargetAs: port
        secrets:
          password: ipmi-secret
---
apiVersion: "cluster.k8s.io/v1alpha1"
kind: Machine
metadata:
  generateName: demo-test-
  labels:
    set: node
spec:
  providerConfig:
    value:
      apiVersion: "extproviderconfig/v1alpha1"
      kind: "ExternalMachineProviderConfig"
      fencingConfig:
        container:
          name: baremetal-fencing
          image: quay.io/beekhof/fence-agents:latest
        createArgs: [ "/sbin/fence_ipmilan", "--user", "admin", "-o", "on", "--ip", "1.2.3.5" ]
        deleteArgs: [ "/sbin/fence_ipmilan", "--user", "admin", "-o", "off", "--ip", "1.2.3.5" ]
        argumentFormat: cli
        passTargetAs: port
        secrets:
          password: ipmi-secret
---
apiVersion: "cluster.k8s.io/v1alpha1"
kind: Machine
metadata:
  generateName: demo-fail-test-
  labels:
    set: node
spec:
  providerConfig:
    value:
      apiVersion: "extproviderconfig/v1alpha1"
      kind: "ExternalMachineProviderConfig"
      fencingConfig:
        container:
          name: baremetal-fencing
          image: quay.io/beekhof/fence-agents:latest
        createArgs: [ "/sbin/fence_ipmilan", "--user", "admin", "-o", "on", "--ip", "1.2.3.5" ]
        deleteArgs: [ "/sbin/fence_ipmilan", "--user", "admin", "-o", "off", "--ip", "1.2.3.5" ]
        argumentFormat: cli
        passTargetAs: port
        secrets:
          password: ipmi-secret
